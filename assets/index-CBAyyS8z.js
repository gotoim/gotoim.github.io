import{c as d,r,j as e,C as k,S as v,I as z,X as C,a as I}from"./x-CCHHPaCC.js";const M=[["path",{d:"M17 21a1 1 0 0 0 1-1v-5.35c0-.457.316-.844.727-1.041a4 4 0 0 0-2.134-7.589 5 5 0 0 0-9.186 0 4 4 0 0 0-2.134 7.588c.411.198.727.585.727 1.041V20a1 1 0 0 0 1 1Z",key:"1qvrer"}],["path",{d:"M6 17h12",key:"1jwigz"}]],S=d("chef-hat",M);const E=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],$=d("download",E);const T=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],_=d("upload",T);const D=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],L=d("wand-sparkles",D),P="AIzaSyD5ifRzw_44bgH6W-99wK1SFCzgLYPivuM",A=a=>new Promise((m,s)=>{const l=new FileReader;l.readAsDataURL(a),l.onload=()=>m(l.result),l.onerror=n=>s(n)}),q=[{label:"白色背景",value:"clean white background, minimal studio lighting"},{label:"黑色背景",value:"elegant black background, dramatic lighting, luxury feel"},{label:"木质背景",value:"rustic wooden table surface, warm atmosphere"},{label:"金属背景",value:"industrial brushed metal texture, cool tones"},{label:"街头小吃风格",value:"vibrant street food style, bokeh city lights background, energetic"},{label:"高级餐厅风格",value:"Michelin star plating, fine dining atmosphere, elegant depth of field"}];function F(){const[a,m]=r.useState(null),[s,l]=r.useState(null),[n,p]=r.useState(""),[o,b]=r.useState(!1),[h,f]=r.useState(null),g=r.useRef(null),j=async t=>{const c=t.target.files[0];if(c)try{const i=await A(c);m(i),l(null)}catch(i){console.error("File read error",i)}},w=t=>{p(t)},N=async()=>{if(!a){alert("请先上传一张食物照片");return}if(!n){alert("请输入一些修改要求或选择标签");return}b(!0);try{const t=a.split(",")[1],c=a.match(/:(.*?);/)[1],i=`
        Identify the food in the image. 
        Without altering the structure of the food itself.
        Commercial food photography style. Exquisite plating, re-pairing of serving dishes, and the interplay of light and shadow make the food look more sophisticated and appealing.
        Specific user request for modification: "${n}".
        The food subject should be perfectly centered.
        The output must be the modified image only.
      `,u=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-image-preview:generateContent?key=${P}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:i},{inlineData:{mimeType:c,data:t}}]}],generationConfig:{responseModalities:["TEXT","IMAGE"]}})});if(!u.ok)throw new Error(`API Error: ${u.status}`);const y=(await u.json()).candidates?.[0]?.content?.parts?.find(x=>x.inlineData);if(y){const x=`data:image/png;base64,${y.inlineData.data}`;l(x)}else alert("生成的图像不可用，请重试。")}catch(t){console.error("Generation error:",t),alert("生成失败，请检查 API Key 或网络连接。")}finally{b(!1)}};return e.jsxs("div",{className:"min-h-screen bg-slate-50 text-slate-800 font-sans selection:bg-yellow-200",children:[e.jsxs("nav",{className:"sticky top-0 z-40 bg-white/80 backdrop-blur-md border-b border-slate-200 px-6 py-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-yellow-400 p-2 rounded-lg rotate-3",children:e.jsx(S,{size:24,className:"text-slate-900"})}),e.jsxs("h1",{className:"text-xl font-bold tracking-tight text-slate-900",children:["Nano Banana ",e.jsx("span",{className:"text-slate-400 font-normal text-sm ml-1",children:"Local Studio"})]})]}),e.jsx("div",{className:"text-xs font-medium text-slate-400 bg-slate-100 px-3 py-1 rounded-full",children:"Local Dev"})]}),e.jsxs("main",{className:"max-w-4xl mx-auto px-4 py-8 pb-32",children:[e.jsxs("section",{className:"relative flex flex-col md:flex-row items-center justify-center gap-8 min-h-[400px] perspective-1000 mb-12",children:[e.jsxs("div",{onClick:()=>g.current?.click(),className:`
              relative group cursor-pointer w-full md:w-[45%] aspect-square bg-white rounded-3xl shadow-xl 
              border-4 border-white transition-all duration-500 ease-out
              md:-rotate-3 md:hover:rotate-0 md:hover:scale-105 hover:z-10 overflow-hidden
              ${a?"":"flex flex-col items-center justify-center bg-slate-100 border-dashed border-slate-300"}
            `,children:[e.jsx("input",{type:"file",ref:g,onChange:j,accept:"image/*",className:"hidden"}),a?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:a,alt:"Original",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:e.jsxs("div",{className:"bg-white/20 backdrop-blur px-4 py-2 rounded-full text-white flex items-center gap-2 font-medium",children:[e.jsx(_,{size:16})," 更换图片"]})})]}):e.jsxs("div",{className:"text-center p-6",children:[e.jsx("div",{className:"w-16 h-16 bg-slate-200 rounded-full flex items-center justify-center mx-auto mb-4 text-slate-400 group-hover:scale-110 transition-transform",children:e.jsx(k,{size:32})}),e.jsx("p",{className:"font-semibold text-slate-600 mb-1",children:"点击上传美食照片"})]})]}),e.jsx("div",{className:"text-yellow-400 z-0 md:rotate-0 rotate-90",children:e.jsx(v,{size:32,className:o?"animate-pulse":""})}),e.jsx("div",{onClick:()=>s&&f(s),className:`
              relative w-full md:w-[45%] aspect-square bg-white rounded-3xl shadow-2xl 
              border-4 border-white transition-all duration-500 ease-out
              md:rotate-3 md:hover:rotate-0 md:hover:scale-105 hover:z-10 overflow-hidden
              ${s?"cursor-zoom-in group":"flex items-center justify-center bg-slate-50"}
            `,children:o?e.jsxs("div",{className:"flex flex-col items-center justify-center p-6 text-center",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-yellow-400 border-t-transparent rounded-full animate-spin mb-4"}),e.jsx("p",{className:"text-slate-800 font-medium animate-pulse",children:"正在烹饪..."})]}):s?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:s,alt:"Generated",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:e.jsxs("div",{className:"bg-white/20 backdrop-blur px-4 py-2 rounded-full text-white flex items-center gap-2 font-medium",children:[e.jsx(z,{size:16})," 查看大图"]})})]}):e.jsxs("div",{className:"text-center p-6 opacity-40",children:[e.jsx("div",{className:"w-16 h-16 bg-slate-200 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(L,{size:28,className:"text-slate-400"})}),e.jsx("p",{className:"font-medium text-slate-500",children:"等待生成..."})]})})]}),e.jsxs("section",{className:"bg-white rounded-3xl shadow-lg p-6 md:p-8 mb-12 border border-slate-100",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-2 ml-1",children:"输入优化要求"}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{value:n,onChange:t=>p(t.target.value),placeholder:"例如：增加热气腾腾的效果，让色彩更鲜艳...",className:"w-full p-4 pr-32 rounded-2xl bg-slate-50 border border-slate-200 focus:border-yellow-400 focus:ring-2 transition-all resize-none h-32 outline-none"}),e.jsxs("button",{onClick:N,disabled:o||!a,className:`
                  absolute bottom-4 right-4 px-6 py-2 rounded-xl font-bold text-sm transition-all flex items-center gap-2 shadow-md
                  ${o||!a?"bg-slate-200 text-slate-400 cursor-not-allowed":"bg-yellow-400 hover:bg-yellow-300 text-slate-900 hover:scale-105"}
                `,children:[o?"生成中...":"开始优化"," ",e.jsx(v,{size:16})]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:q.map(t=>e.jsx("button",{onClick:()=>w(t.value),className:"px-4 py-2 rounded-xl bg-slate-50 border border-slate-200 text-slate-600 text-sm hover:border-yellow-400 hover:bg-yellow-50 transition-colors",children:t.label},t.label))})]})]}),h&&e.jsxs("div",{className:"fixed inset-0 z-50 bg-black/90 backdrop-blur-sm flex items-center justify-center p-4",children:[e.jsx("button",{onClick:()=>f(null),className:"absolute top-6 right-6 text-white p-2",children:e.jsx(C,{size:24})}),e.jsxs("div",{className:"max-w-5xl w-full flex flex-col items-center",children:[e.jsx("img",{src:h,alt:"Full",className:"max-w-full max-h-[80vh] object-contain rounded-lg"}),e.jsxs("button",{onClick:()=>{const t=document.createElement("a");t.href=h,t.download=`nano-banana-${Date.now()}.png`,document.body.appendChild(t),t.click(),document.body.removeChild(t)},className:"mt-6 bg-white text-slate-900 px-6 py-3 rounded-full font-bold flex items-center gap-2",children:[e.jsx($,{size:18})," 下载图片"]})]})]}),e.jsx("style",{children:".perspective-1000 { perspective: 1000px; }"})]})}I.createRoot(document.getElementById("root")).render(e.jsx(r.StrictMode,{children:e.jsx(F,{})}));
